<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>P. vivax Model • malariasimulation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="P. vivax Model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">malariasimulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Model.html">Model Introduction</a>
    </li>
    <li>
      <a href="../articles/Demography.html">Demography</a>
    </li>
    <li>
      <a href="../articles/Treatment.html">Treatment</a>
    </li>
    <li>
      <a href="../articles/MDA.html">MDA and Chemoprevention</a>
    </li>
    <li>
      <a href="../articles/Vaccines.html">Vaccines</a>
    </li>
    <li>
      <a href="../articles/VectorControl_Bednets.html">Vector Control: Bednets</a>
    </li>
    <li>
      <a href="../articles/VectorControl_IRS.html">Vector Control: Indoor Residual Spraying</a>
    </li>
    <li>
      <a href="../articles/SetSpecies.html">Mosquito Species</a>
    </li>
    <li>
      <a href="../articles/Carrying-capacity.html">Carrying Capacity</a>
    </li>
    <li>
      <a href="../articles/EIRprevmatch.html">Matching PfPR2-10 to EIR</a>
    </li>
    <li>
      <a href="../articles/Metapopulation.html">Metapopulation Modelling</a>
    </li>
    <li>
      <a href="../articles/Variation.html">Stochastic Variation</a>
    </li>
    <li>
      <a href="../articles/Parameter_variation.html">Parameter Variation</a>
    </li>
    <li>
      <a href="../articles/Plasmodium_vivax.html">Plasmodium Vivax</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/malariasimulation" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>P. vivax Model</h1>
            
      

      <div class="hidden name"><code>Plasmodium_vivax.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the requisite packages:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">malariasimulation</span><span class="op">)</span></span>
<span><span class="co"># Set colour palette:</span></span>
<span><span class="va">cols</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span></span></code></pre></div>
<p>This vignette describes the unique features of the <em>P. vivax</em>
model.</p>
<div class="section level2">
<h2 id="using-the-p--vivax-model">Using the <em>P. vivax</em> model<a class="anchor" aria-label="anchor" href="#using-the-p--vivax-model"></a>
</h2>
<p>To select the <em>P. vivax</em> model, use the <code>parasite</code>
argument in the <code><a href="../reference/get_parameters.html">get_parameters()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span>parasite <span class="op">=</span> <span class="st">"vivax"</span><span class="op">)</span></span></code></pre></div>
<p>Then we can run the simulation as normal:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span>timesteps <span class="op">=</span> <span class="fl">100</span>, parameters <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-details">Model details<a class="anchor" aria-label="anchor" href="#model-details"></a>
</h2>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>Our default <em>P. vivax</em> parameters are sourced from a version
of the analysis in White et al. 2018 (doi: 10.1038/s41467-018-05860-8),
where model parameters were fitted to data from Papua New Guinea. The
chosen parameter set fixes <code>b = 0.25</code> and
<code>sigma_squared = 1.67</code> (for consistency with the <em>P.
falciparum</em> model). The default parameters for both parasite species
can be found in <code>data/raw/parasite_parameters.csv</code>, while
parameters common to both models are given in
<code>R/parameters.R</code> under <code><a href="../reference/get_parameters.html">get_parameters()</a></code>.</p>
<p>Values for the model fitting posterior distribution can be selected
using the <code><a href="../reference/set_parameter_draw.html">set_parameter_draw()</a></code> function as found in the <a href="https://mrc-ide.github.io/malariasimulation/articles/ParameterVariation.html" class="external-link">Parameter
Variation</a> vignette.</p>
</div>
<div class="section level3">
<h3 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a>
</h3>
<p>The <em>P. falciparum</em> model has five human disease compartments:
susceptible (S), clinical disease (D), asymptomatic infection (A),
sub-patent infection (U), and treated (Tr). Asymptomatic infections may
or may not be detectable by light-microscopy.</p>
<p>The <em>P. vivax</em> model follows a similar structure to the <em>P.
falciparum</em> model, and also has five human disease compartments.
However, the human disease states modeled explicitly focus on parasite
density and detectability, such that we have: susceptible (S), clinical
disease (D), <strong>light-microscopy detectable infection (A)</strong>,
<strong>PCR detectable infection (U)</strong>, and treated (Tr).</p>
</div>
<div class="section level3">
<h3 id="new-infections">New Infections<a class="anchor" aria-label="anchor" href="#new-infections"></a>
</h3>
<p>The rate of infection for an individual who has been bitten increases
with the number of bites they have received in the <em>P. vivax</em>
model. In contrast, the rate of infection in the <em>P. falciparum</em>
model is independent of the number of bites an individual has
received.</p>
<p>Newly infected individuals in the <em>P. falciparum</em> model can
move into either the clinically diseased or asymptomatic infection
compartment. In addition to these compartments, the <em>P. vivax</em>
model allows infection to the PCR-detectable compartment (U), where the
assignment of light-miscroscopy detectable infections and PCR-detectable
infections is mediated by anti-parasite immunity.</p>
</div>
<div class="section level3">
<h3 id="immunity">Immunity<a class="anchor" aria-label="anchor" href="#immunity"></a>
</h3>
<p>The <em>P. falciparum</em> model tracks four kinds of immunity:
immunity to blood stage infection (IB), clinical disease (acquired and
maternal, ICA and ICM), to severe disease (acquired and maternal, IVA
and IVM), and to detectability (ID).</p>
<p>The <em>P. vivax</em> model tracks two kinds of immunity: immunity to
clinical infection (acquired and maternal, ICA and ICM) and
anti-parasite immunity (acquired and maternal, IAA and IAM). We do not
track immunity to blood stage infections, severe immunity or immunity to
detectability.</p>
<p>Anti-parasite immunity has effects in two places. The first is in the
separation of PCR-detectable infections from LM-detectable infections
(where greater immunity reduces the change of an infection with higher
parasitaemia). The second is in the calculation of a PCR-detectable
infection (where greater immunity results in a shorter duration before
recovery). The <em>P. falciparum</em> model does not model infections to
the sub-patent compartment (U) and has a constant sub-patent infection
duration (<code>du = 110</code>).</p>
</div>
<div class="section level3">
<h3 id="infectivity-of-lm-detectable-infections">Infectivity of LM-detectable infections<a class="anchor" aria-label="anchor" href="#infectivity-of-lm-detectable-infections"></a>
</h3>
<p>While the <em>P. falciparum</em> model calculates the onward
infectivity of asymptomatic infections (<code>ca</code>) using the age
and detectability immunity of each individual, the <em>P. vivax</em>
model uses a constant onwards infectivity for LM-detectable infections
(<code>ca = 0.1</code>).</p>
</div>
<div class="section level3">
<h3 id="hypnozoites">Hypnozoites<a class="anchor" aria-label="anchor" href="#hypnozoites"></a>
</h3>
<p>The <em>P. vivax</em> model tracks the number of hypnozoite batches
of each individual which then contribute to the rate of new infections.
Acquisition of new batches come from bite infections, which are mediated
by liver-stage drug prophylaxis, and are capped (where
<code>kmax = 10</code> by default). All individuals can acquire new
hypnozoite batches via bites, even when these do not result in new
blood-stage infection (as in the clinically diseased and treated).
Hypnozoite batches are lost probabilistically where an individual’s
number of batches determines the loss rate of a single batch.</p>
<p>Successful liver-stage drug treatment results in the clearing of all
hypnozoite batches of an individual.</p>
</div>
<div class="section level3">
<h3 id="drug-treatment">Drug treatment<a class="anchor" aria-label="anchor" href="#drug-treatment"></a>
</h3>
<p>While <em>P. falciparum</em> drugs have four parameters (efficacy,
relative reduction in onwards infectivity, and two prophylaxis
parameters: shape and scale), the <em>P. vivax</em> drug parameters may
have four (if the drug only targets the blood stage infection) or seven
parameters (if the drug also targets hypnozoites). These three
additional parameters are drug efficacy on hypnozoite clearance and two
hypnozoite prophylaxis parameters: shape and scale. The hypnozoite
prophylaxis functions the same way as standard prophlylaxis to
infection, but reduced the probability that a bite infection results in
the formation of a new hypnozoite batch.</p>
</div>
<div class="section level3">
<h3 id="equilibrium">Equilibrium<a class="anchor" aria-label="anchor" href="#equilibrium"></a>
</h3>
<p>The malariaEquilibriumVivax package has been designed to calculate
the equilibrium solution for the <em>P. vivax</em> model. This
equilibrium is calculated by assigning an initial EIR value via the
<code>set_equilibrium</code> function, as in the <em>P. falciparum</em>
model. Based on the age and heterogeneity group of an individual, it
assigns a human disease state, clinical and anti-parasite immunities and
number of hypnozoite batches.</p>
</div>
<div class="section level3">
<h3 id="key-model-references">Key Model References<a class="anchor" aria-label="anchor" href="#key-model-references"></a>
</h3>
<p>White, M. T., Walker, P., Karl, S., Hetzel, M. W., Freeman, T.,
Waltmann, A., Laman, M., Robinson, L. J., Ghani, A., &amp; Mueller, I.
(2018). Mathematical modelling of the impact of expanding levels of
malaria control interventions on Plasmodium vivax. Nature
Communications, 9(1), 1–10. <a href="https://doi.org/10.1038/s41467-018-05860-8" class="external-link uri">https://doi.org/10.1038/s41467-018-05860-8</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Giovanni Charles, Peter Winskill, Hillary Topazian, Joseph Challenger, Richard Fitzjohn, Richard Sheppard, Tom Brewer, Kelly McCain, Lydia Haile.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
