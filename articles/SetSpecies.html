<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mosquito species • malariasimulation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mosquito species">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">malariasimulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Model.html">Model Introduction</a>
    </li>
    <li>
      <a href="../articles/Demography.html">Demography</a>
    </li>
    <li>
      <a href="../articles/Treatment.html">Treatment</a>
    </li>
    <li>
      <a href="../articles/MDA.html">MDA and Chemoprevention</a>
    </li>
    <li>
      <a href="../articles/Vaccines.html">Vaccines</a>
    </li>
    <li>
      <a href="../articles/VectorControl_Bednets.html">Vector Control: Bednets</a>
    </li>
    <li>
      <a href="../articles/VectorControl_IRS.html">Vector Control: Indoor Residual Spraying</a>
    </li>
    <li>
      <a href="../articles/SetSpecies.html">Mosquito Species</a>
    </li>
    <li>
      <a href="../articles/Carrying-capacity.html">Carrying Capacity</a>
    </li>
    <li>
      <a href="../articles/EIRprevmatch.html">Matching PfPR2-10 to EIR</a>
    </li>
    <li>
      <a href="../articles/Metapopulation.html">Metapopulation Modelling</a>
    </li>
    <li>
      <a href="../articles/Variation.html">Stochastic Variation</a>
    </li>
    <li>
      <a href="../articles/Parameter_variation.html">Parameter Variation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/malariasimulation" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mosquito species</h1>
            
      

      <div class="hidden name"><code>SetSpecies.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the requisite packages:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">malariasimulation</span><span class="op">)</span></span>
<span><span class="co"># Set colour palette:</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span></span></code></pre></div>
<p>As alluded to in the Model Structure, Vector Control: IRS, and Vector
Control: Bed net vignettes, it is possible to account for varying
proportions of mosquito species in the setting you are modelling using
the <code><a href="../reference/set_species.html">set_species()</a></code> function. IRS and bed nets could be
expected to have different impacts depending on the proportion of each
mosquito species because of variations in indoor resting, insecticide
resistance, and proportion of bites on humans versus animals by species.
If you have specified more than 1 species, then the arguments for
<code><a href="../reference/set_spraying.html">set_spraying()</a></code> and/or <code><a href="../reference/set_bednets.html">set_bednets()</a></code> must be
populated with values for each species at each timestep that the
intervention is implemented.</p>
<p>There are preset parameters for <em>An. gambiae</em>, <em>An.
arabiensis</em>, <em>An. funestus</em> and <em>An. stephensi</em> that
can be set by the helper objects <code>gamb_params</code>,
<code>arab_params</code>, <code>fun_params</code> and
<code>steph_params</code>, respectively. The default values for each
species in these helper functions are from <a href="https://doi.org/10.1038/s41467-018-07357-w" class="external-link">Sherrard-Smith et al.,
2018</a>. The parameters are:</p>
<ul>
<li>
<code>species</code>: the mosquito species name or signifier</li>
<li>
<code>blood_meal_rates</code>: the blood meal rates for each
species</li>
<li>
<code>foraging_time</code>: time spent taking blood meals<br>
</li>
<li>
<code>Q0</code>: proportion of blood meals taken on humans<br>
</li>
<li>
<code>phi_bednets</code>: proportion of bites taken in bed<br>
</li>
<li>
<code>phi_indoors</code>: proportion of bites taken indoors</li>
</ul>
<p>We will demonstrate how to specify different mosquito species and how
this could alter intervention impact using an example with IRS.</p>
<p>We will create a plotting function to visualise the output.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plotting functions</span></span>
<span><span class="va">plot_prev</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">output_endophilic</span><span class="op">$</span><span class="va">timestep</span>, y <span class="op">=</span> <span class="va">output_endophilic</span><span class="op">$</span><span class="va">n_detect_lm_730_3650</span> <span class="op">/</span> <span class="va">output_endophilic</span><span class="op">$</span><span class="va">n_age_730_3650</span>, </span>
<span>       type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time (days)"</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">Pf</span><span class="op">)</span>,<span class="st">"PR"</span><span class="op">[</span><span class="fl">2</span><span class="op">-</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">output_exophilic</span><span class="op">$</span><span class="va">timestep</span>, y <span class="op">=</span> <span class="va">output_exophilic</span><span class="op">$</span><span class="va">n_detect_lm_730_3650</span> <span class="op">/</span> <span class="va">output_exophilic</span><span class="op">$</span><span class="va">n_age_730_3650</span>,</span>
<span>        col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">sprayingtimesteps</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2.5</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sprayingtimesteps</span> <span class="op">+</span> <span class="fl">10</span>, y <span class="op">=</span> <span class="fl">0.9</span>, labels <span class="op">=</span> <span class="st">"Spraying\nint."</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey80"</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, box.lty <span class="op">=</span> <span class="fl">0</span>, </span>
<span>         legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prevalence for endophilic mosquitoes"</span>, <span class="st">"Prevalence for exophilic mosquitoes"</span><span class="op">)</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">cols</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, y.intersp <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">species_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Mos_pops</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mos_pops</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">Mos_pops</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Mos_pops</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fl">1.25</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Mosquito population size"</span>, xlab <span class="op">=</span> <span class="st">"Days"</span>,</span>
<span>       xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey80"</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mos_pops</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">Mos_pops</span><span class="op">[</span>,<span class="va">x</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A. arab"</span>,<span class="st">"A. fun"</span>,<span class="st">"A. gamb"</span><span class="op">)</span>,</span>
<span>         col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="setting-mosquito-species-parameters">Setting mosquito species parameters<a class="anchor" aria-label="anchor" href="#setting-mosquito-species-parameters"></a>
</h2>
<div class="section level3">
<h3 id="single-endophilic-mosquito-species">Single endophilic mosquito species<a class="anchor" aria-label="anchor" href="#single-endophilic-mosquito-species"></a>
</h3>
<p>Use the <code><a href="../reference/get_parameters.html">get_parameters()</a></code> function to generate a list of
parameters, accepting most of the default values, but modifying
seasonality values to model a seasonal setting. We will use
<code>set_species</code> to model mosquitoes similar to <em>An.
funestus</em> but with a higher propensity to bite indoors (which we
will name “endophilic”). Then, we use the <code><a href="../reference/set_equilibrium.html">set_equilibrium()</a></code>
function to to initialise the model at a given entomological inoculation
rate (EIR).</p>
<p>We used the <code><a href="../reference/set_spraying.html">set_spraying()</a></code> function to set an IRS
intervention. This function takes as arguments the parameter list,
timesteps of spraying, coverage of IRS in the population and a series of
parameters related to the insecticide used in the IRS. The proportion of
mosquitoes dying following entering a hut is dependent on the parameters
<code>ls_theta</code>, the initial efficacy, and <code>ls_gamma</code>,
how it changes over time. The proportion of mosquitoes successfully
feeding is dependent on <code>ks_theta</code>, the initial impact of the
insecticide in IRS, and <code>ks_gamma</code>, how the impact changes
over time. Finally, the proportion of mosquitoes being deterred away
from a sprayed hut depends on <code>ms_theta</code>, the initial impact
of IRS, and <code>ms_gamma</code>, the change in impact over time. See a
more comprehensive explanation in the Supplementary Information of <a href="https://doi.org/10.1038/s41467-018-07357-w" class="external-link">Sherrard-Smith et al.,
2018</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fl">365</span></span>
<span><span class="va">month</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">sim_length</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">year</span></span>
<span><span class="va">human_population</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">starting_EIR</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    human_population <span class="op">=</span> <span class="va">human_population</span>,</span>
<span>    <span class="co"># seasonality parameters</span></span>
<span>    model_seasonality <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    g0 <span class="op">=</span> <span class="fl">0.285277</span>,</span>
<span>    g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0248801</span>, <span class="op">-</span><span class="fl">0.0529426</span>, <span class="op">-</span><span class="fl">0.0168910</span><span class="op">)</span>,</span>
<span>    h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0216681</span>, <span class="op">-</span><span class="fl">0.0242904</span>, <span class="op">-</span><span class="fl">0.0073646</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peak_season_offset.html">peak_season_offset</a></span><span class="op">(</span><span class="va">simparams</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an example mosquito species (named endophilic) with a high value for `phi_indoors`</span></span>
<span><span class="va">endophilic_mosquito_params</span> <span class="op">&lt;-</span> <span class="va">fun_params</span></span>
<span><span class="va">endophilic_mosquito_params</span><span class="op">$</span><span class="va">phi_indoors</span> <span class="op">&lt;-</span> <span class="fl">0.9</span></span>
<span><span class="va">endophilic_mosquito_params</span><span class="op">$</span><span class="va">species</span> <span class="op">&lt;-</span> <span class="st">'endophilic'</span></span>
<span></span>
<span><span class="co">## Set mosquito species  with a high propensity for indoor biting</span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_species.html">set_species</a></span><span class="op">(</span></span>
<span>  <span class="va">simparams</span>, </span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">endophilic_mosquito_params</span><span class="op">)</span>,</span>
<span>  proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sprayingtimesteps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">year</span> <span class="op">+</span> <span class="va">peak</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">month</span> <span class="co"># There is a round of IRS in the 1st and second year 3 months prior to peak transmission.</span></span>
<span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_spraying.html">set_spraying</a></span><span class="op">(</span></span>
<span>  <span class="va">simparams</span>,</span>
<span>  timesteps <span class="op">=</span> <span class="va">sprayingtimesteps</span>,</span>
<span>  coverages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># # Each round covers 80% of the population </span></span>
<span>  <span class="co"># nrows=length(timesteps), ncols=length(species) </span></span>
<span>  ls_theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">2.025</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of mortality parameters per round of IRS and per species </span></span>
<span>  ls_gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.009</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of mortality parameters per round of IRS and per species</span></span>
<span>  ks_theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.222</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of feeding success parameters per round of IRS and per species</span></span>
<span>  ks_gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.008</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of feeding success parameters per round of IRS and per species</span></span>
<span>  ms_theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.232</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of deterrence parameters per round of IRS and per species</span></span>
<span>  ms_gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.009</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Matrix of deterrence parameters per round of IRS and per species</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_equilibrium.html">set_equilibrium</a></span><span class="op">(</span><span class="va">simparams</span>, <span class="va">starting_EIR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Running simulation with IRS</span></span>
<span><span class="va">output_endophilic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span>timesteps <span class="op">=</span> <span class="va">sim_length</span>, parameters <span class="op">=</span> <span class="va">simparams</span><span class="op">)</span></span></code></pre></div>
<p>We can see below that only the endophilic species is modelled.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simparams</span><span class="op">$</span><span class="va">species</span></span>
<span><span class="co">#&gt; [1] "endophilic"</span></span>
<span><span class="va">simparams</span><span class="op">$</span><span class="va">species_proportions</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="single-exophilic-mosquito-species">Single exophilic mosquito species<a class="anchor" aria-label="anchor" href="#single-exophilic-mosquito-species"></a>
</h3>
<p>We will run the same model with IRS as above, but this time with an
example mosquito species similar to <em>An. funestus</em>, but with a
lower propensity to bite indoors (which we will name “exophilic”). Note
that now there are two rows for the <code>ls_theta</code>,
<code>ls_gamma</code>, <code>ks_theta</code>, <code>ks_gamma</code>,
<code>ms_theta</code>, and <code>ms_gamma</code> arguments (rows
represent timesteps where changes occur, columns represent additional
species). See the Vector Control: IRS vignette for more information
about setting IRS with different mosquito species.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an example mosquito species (named exophilic) with a low value for `phi_indoors`</span></span>
<span><span class="va">exophilic_mosquito_params</span> <span class="op">&lt;-</span> <span class="va">fun_params</span></span>
<span><span class="va">exophilic_mosquito_params</span><span class="op">$</span><span class="va">phi_indoors</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">exophilic_mosquito_params</span><span class="op">$</span><span class="va">species</span> <span class="op">&lt;-</span> <span class="st">'exophilic'</span></span>
<span></span>
<span><span class="co">## Set mosquito species  with a low propensity for indoor biting</span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_species.html">set_species</a></span><span class="op">(</span></span>
<span>  <span class="va">simparams</span>, </span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">exophilic_mosquito_params</span><span class="op">)</span>,</span>
<span>  proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peak_season_offset.html">peak_season_offset</a></span><span class="op">(</span><span class="va">simparams</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sprayingtimesteps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">year</span> <span class="op">+</span> <span class="va">peak</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">month</span> <span class="co"># There is a round of IRS in the 1st and second year 3 months prior to peak transmission.</span></span>
<span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_spraying.html">set_spraying</a></span><span class="op">(</span></span>
<span>  <span class="va">simparams</span>,</span>
<span>  timesteps <span class="op">=</span> <span class="va">sprayingtimesteps</span>,</span>
<span>  coverages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># # Each round covers 80% of the population </span></span>
<span>  <span class="co"># nrows=length(timesteps), ncols=length(species) </span></span>
<span>  ls_theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">2.025</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of mortality parameters</span></span>
<span>  ls_gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.009</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of mortality parameters per round of IRS and per species</span></span>
<span>  ks_theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.222</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of feeding success parameters per round of IRS and per species</span></span>
<span>  ks_gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.008</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of feeding success parameters per round of IRS and per species</span></span>
<span>  ms_theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.232</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Matrix of deterrence parameters per round of IRS and per species</span></span>
<span>  ms_gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.009</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sprayingtimesteps</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Matrix of deterrence parameters per round of IRS and per species</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_exophilic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span>timesteps <span class="op">=</span> <span class="va">sim_length</span>, parameters <span class="op">=</span> <span class="va">simparams</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-adult-female-infectious-mosquitoes-by-species-over-time">Plot adult female infectious mosquitoes by species over time<a class="anchor" aria-label="anchor" href="#plot-adult-female-infectious-mosquitoes-by-species-over-time"></a>
</h3>
<p>In the plot below, we can see that IRS is much more effective when
the endophilic mosquito species is modelled compared to the scenario
where an exophilic species is modelled. In this case, IRS will not be as
effective because a larger proportion of bites take place outside of the
home.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_prev</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="SetSpecies_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="setting-multiple-mosquito-species">Setting multiple mosquito species<a class="anchor" aria-label="anchor" href="#setting-multiple-mosquito-species"></a>
</h2>
<p>Finally, we give an example of how to set multiple mosquito
species.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Update parameter list with species distributions</span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    human_population <span class="op">=</span> <span class="va">human_population</span>,</span>
<span>    <span class="co"># seasonality parameters</span></span>
<span>    model_seasonality <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    g0 <span class="op">=</span> <span class="fl">0.285277</span>,</span>
<span>    g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0248801</span>, <span class="op">-</span><span class="fl">0.0529426</span>, <span class="op">-</span><span class="fl">0.0168910</span><span class="op">)</span>,</span>
<span>    h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0216681</span>, <span class="op">-</span><span class="fl">0.0242904</span>, <span class="op">-</span><span class="fl">0.0073646</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">params_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_species.html">set_species</a></span><span class="op">(</span>parameters <span class="op">=</span> <span class="va">simparams</span>,</span>
<span>                              species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">arab_params</span>, <span class="va">fun_params</span>, <span class="va">gamb_params</span><span class="op">)</span>,</span>
<span>                              proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run simulation</span></span>
<span><span class="va">species_simulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span>timesteps <span class="op">=</span> <span class="va">sim_length</span>, parameters <span class="op">=</span> <span class="va">params_species</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot species distributions</span></span>
<span><span class="va">Mos_sp_dist_sim</span> <span class="op">&lt;-</span> <span class="va">species_simulation</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timestep"</span>, <span class="st">"total_M_arab"</span>, <span class="st">"total_M_fun"</span>, <span class="st">"total_M_gamb"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">species_plot</span><span class="op">(</span><span class="va">Mos_sp_dist_sim</span><span class="op">)</span></span></code></pre></div>
<p><img src="SetSpecies_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Giovanni Charles, Peter Winskill, Hillary Topazian, Joseph Challenger, Richard Fitzjohn, Richard Sheppard, Tom Brewer, Kelly McCain, Lydia Haile.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
