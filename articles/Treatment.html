<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Treatment â€¢ malariasimulation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Treatment">
<meta property="og:description" content="malariasimulation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">malariasimulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Model.html">Model Introduction</a>
    </li>
    <li>
      <a href="../articles/Demography.html">Demography</a>
    </li>
    <li>
      <a href="../articles/Treatment.html">Treatment</a>
    </li>
    <li>
      <a href="../articles/MDA.html">MDA and Chemoprevention</a>
    </li>
    <li>
      <a href="../articles/Vaccines.html">Vaccines</a>
    </li>
    <li>
      <a href="../articles/VectorControl_Bednets.html">Vector Control: Bednets</a>
    </li>
    <li>
      <a href="../articles/VectorControl_IRS.html">Vector Control: Indoor Residual Spraying</a>
    </li>
    <li>
      <a href="../articles/SetSpecies.html">Mosquito Species</a>
    </li>
    <li>
      <a href="../articles/Carrying-capacity.html">Carrying Capacity</a>
    </li>
    <li>
      <a href="../articles/EIRprevmatch.html">Matching PfPR2-10 to EIR</a>
    </li>
    <li>
      <a href="../articles/Metapopulation.html">Metapopulation Modelling</a>
    </li>
    <li>
      <a href="../articles/Variation.html">Stochastic Variation</a>
    </li>
    <li>
      <a href="../articles/Parameter_variation.html">Parameter Variation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/malariasimulation" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Treatment</h1>
            
      
      
      <div class="hidden name"><code>Treatment.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the requisite packages:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">malariasimulation</span><span class="op">)</span></span>
<span><span class="co"># Set colour palette:</span></span>
<span><span class="va">cols</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span></span></code></pre></div>
<p>This vignette describes how to implement clinical drug treatments in
malariasimulation.</p>
<p>The malariasimulation package contains built-in parameters sets for
three anti-malarial drugs:</p>
<ol style="list-style-type: decimal">
<li>
<code>AL_params</code>: artemether-lumefantrine (AL)</li>
<li>
<code>DHA_PQP_params</code>: dihydroartemisinin and piperaquine
(DHA-PQP)</li>
<li>
<code>SP_AQ_params</code>: sulfadoxine-pyrimethamine and amodiaquine
(SP-AQ)</li>
</ol>
<p>While all these drugs can be used to treat malaria, DHA-PQP and SP-AQ
remain in the body for some time following treatment, making them good
candidates for chemoprevention in mass drug administrations (see <a href="https://mrc-ide.github.io/malariasimulation/articles/MDA.html" class="external-link">Mass
Drug Administration and Chemoprevention</a>). Any of these drugs can be
included in the parameter list using the <code><a href="../reference/set_drugs.html">set_drugs()</a></code>
function (see <a href="https://github.com/mrc-ide/malariasimulation/blob/master/R/drug_parameters.R" class="external-link">drugs_parameters.R</a>
for full parameter details).</p>
<p>Each drug parameter set is a vector of length four, with parameters
that represent the drug efficacy, the infectiousness following treatment
relative to an untreated infection, and parameters that determine the
protection against reinfection (<span class="math inline">\(P\)</span>):
shape (<span class="math inline">\(w\)</span>) and scale (<span class="math inline">\(\lambda\)</span>). The decay of protection against
infection follows a weibull distribution as follows:</p>
<p><span class="math display">\[P = e^{{(-t/\lambda)}^w}\]</span></p>
<p>The <span class="math inline">\(P\)</span> for each drug following
treatment through time is plotted below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calc_P</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span>, <span class="va">lambda</span>, <span class="va">t</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">t</span><span class="op">/</span><span class="va">lambda</span><span class="op">)</span><span class="op">^</span><span class="va">w</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">70</span></span>
<span></span>
<span><span class="va">P_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">AL_params</span>, <span class="va">DHA_PQP_params</span>, <span class="va">SP_AQ_params</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">calc_P</span><span class="op">(</span>w <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, lambda <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, t <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">P_matrix</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Days"</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Protection against reinfection ("</span>,<span class="fu">italic</span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey80"</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">P_matrix</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AL"</span>,<span class="st">"DHA-PQP"</span>,<span class="st">"SP-AQ"</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">cols</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Treatment_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>For more details, please see:</p>
<p>Okell, L., Cairns, M., Griffin, J. <em>et al.</em> Contrasting
benefits of different artemisinin combination therapies as first-line
malaria treatments using model-based cost-effectiveness analysis.
<em>Nat Commun</em> <strong>5</strong>, 5606 (2014). <a href="https://doi.org/10.1038/ncomms6606" class="external-link uri">https://doi.org/10.1038/ncomms6606</a>.</p>
<div class="section level2">
<h2 id="setting-drugs-and-clinical-treatment">Setting drugs and clinical treatment<a class="anchor" aria-label="anchor" href="#setting-drugs-and-clinical-treatment"></a>
</h2>
<p>Drug parameters can be incorporated into a complete parameter set
using the <code><a href="../reference/set_drugs.html">set_drugs()</a></code> function which takes the full
parameter set and a list of drug parameter sets.</p>
<p>A treatment regimen for each drug can then be described using the
<code><a href="../reference/set_clinical_treatment.html">set_clinical_treatment()</a></code> function which takes the drug
index, a vector of timesteps at which a change in coverage occurs (where
the initial coverage is 0 until the first timestep specified) and a
vector of coverages for the drug that correspond with the timestep
changes, as well as the complete parameter set.</p>
<p>Multiple drugs can be modelled simultaneously, with treatment
coverage that can be specified for each drug. This function must be used
for each drug included (e.g., if there are two drugs,
<code><a href="../reference/set_clinical_treatment.html">set_clinical_treatment()</a></code> must be called twice to specify
the treatment plan).</p>
<div class="section level3">
<h3 id="parameterisation-and-simulation">Parameterisation and simulation<a class="anchor" aria-label="anchor" href="#parameterisation-and-simulation"></a>
</h3>
<p>We will run a simulation for two years using AL and DHA-PQP treatment
regimens. We begin our AL and DHA-PQP treatments on day 300 at 40% and
30% coverage, respectively. We provide these treatments for 300 days
before the regimen ends. Note that the sum of treatment coverages cannot
exceed 100% at any timestep.</p>
<p>Prior to the simulation, the function <code>set_equilibrium</code>
can also be used to generate equilibrium values for the human and
mosquito populations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Daily simulation timesteps for two years</span></span>
<span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fl">365</span></span>
<span><span class="va">sim_length</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">year</span></span>
<span></span>
<span><span class="co"># With a population size of 1000</span></span>
<span><span class="va">human_population</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Set human population size</span></span>
<span><span class="va">simparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span>overrides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>human_population <span class="op">=</span> <span class="va">human_population</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update parameter set with chosen drug-specific parameters (AL and DHA/PQP)</span></span>
<span><span class="va">drug_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_drugs.html">set_drugs</a></span><span class="op">(</span><span class="va">simparams</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">AL_params</span>, <span class="va">DHA_PQP_params</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Choose initial EIR to 10</span></span>
<span><span class="va">starting_EIR</span> <span class="op">&lt;-</span> <span class="fl">10</span> </span>
<span></span>
<span><span class="co"># Set treatment program for AL (drug index = 1)</span></span>
<span><span class="va">treatment_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_clinical_treatment.html">set_clinical_treatment</a></span><span class="op">(</span></span>
<span>  parameters <span class="op">=</span> <span class="va">drug_params</span>,</span>
<span>  drug <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  timesteps <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>,<span class="fl">600</span><span class="op">)</span>, <span class="co"># Treatment coverage changes on day 300 and day 600</span></span>
<span>  coverages <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co"># The initial treatment coverage (0%) is the default </span></span>
<span><span class="co"># and does not need to be set</span></span>
<span></span>
<span><span class="co"># Set treatment program for DHA-PQP (drug index = 2)</span></span>
<span><span class="va">treatment_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_clinical_treatment.html">set_clinical_treatment</a></span><span class="op">(</span></span>
<span>  parameters <span class="op">=</span> <span class="va">treatment_params</span>,</span>
<span>  drug <span class="op">=</span>  <span class="fl">2</span>,</span>
<span>  timesteps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>,<span class="fl">600</span><span class="op">)</span>,</span>
<span>  coverages <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Use set_equilibrium to update the parameter set for a given initial EIR</span></span>
<span><span class="va">treatment_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_equilibrium.html">set_equilibrium</a></span><span class="op">(</span><span class="va">treatment_params</span>, <span class="va">starting_EIR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run simulation:</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span><span class="va">sim_length</span>, <span class="va">treatment_params</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h3>
<p>Following simulation of malaria transmission under this treatment
regimen, we can now visualise the effect of the regimen on the number of
detectable cases through time using the
<code>n_detect_730_3650</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">output</span><span class="op">$</span><span class="va">timestep</span>, y <span class="op">=</span> <span class="va">output</span><span class="op">$</span><span class="va">n_detect_730_3650</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Days"</span>, ylab <span class="op">=</span> <span class="st">"Detectable cases"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">n_detect_730_3650</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">n_detect_730_3650</span><span class="op">)</span><span class="op">+</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>     xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show treatment times</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">300</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">310</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">n_detect_730_3650</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Treatment\nbegins"</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">600</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">610</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">n_detect_730_3650</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Treatment\nends"</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add grid lines</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey80"</span>, nx <span class="op">=</span> <span class="fl">11</span>, ny <span class="op">=</span> <span class="fl">10</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="Treatment_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Giovanni Charles, Peter Winskill, Hillary Topazian, Joseph Challenger, Richard Fitzjohn, Richard Sheppard, Tom Brewer, Kelly McCain, Lydia Haile.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
